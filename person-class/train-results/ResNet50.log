INFO:root:Creating model with cnn base: ResNet50
INFO:root:batch size: 32, dense units 128, dropout: 0.2
INFO:root:learning rate: 0.0001, l2 penalty: 0.0001, freeze 85
WARNING:tensorflow:From /home/lindo/.virtualenvs/od/local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From /home/lindo/.virtualenvs/od/local/lib/python3.6/site-packages/tensorflow_core/python/ops/init_ops.py:97: calling GlorotUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/lindo/.virtualenvs/od/local/lib/python3.6/site-packages/tensorflow_core/python/ops/init_ops.py:97: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/lindo/.virtualenvs/od/local/lib/python3.6/site-packages/tensorflow_core/python/ops/init_ops.py:97: calling Ones.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
INFO:root:Getting dataframe.
INFO:root:Class dict: {'Unknown': 0, 'eva_st_angel': 1, 'lindo_st_angel': 2, 'nico_st_angel': 3, 'nikki_st_angel': 4}
INFO:root:Number of training samples: 5144
INFO:root:Number of validation samples: 1286
INFO:root:Class weights: {4: 2.536340852130326, 1: 3.734317343173432, 2: 1.8585858585858586, 3: 2.9290882778581766, 0: 1.0}
INFO:root:Steps per epoch: 160
INFO:root:Validation steps: 40
INFO:root:Starting pass 1.
INFO:root:Finished pass 1.
INFO:root:Starting pass 2 with learning rate: 1e-05
INFO:root:Starting pass 2 with final pass 1 model.
INFO:root:Finished pass 2.
INFO:root:Starting coversion of keras model to frozen TF model.
INFO:root:Input node name(s) are: ['resnet50_input']
INFO:root:Output node name(s) are: ['dense_1/Softmax']
WARNING:tensorflow:From ./train.py:129: The name tf.keras.backend.get_session is deprecated. Please use tf.compat.v1.keras.backend.get_session instead.

WARNING:tensorflow:From ./train.py:133: convert_variables_to_constants (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.convert_variables_to_constants`
WARNING:tensorflow:From /home/lindo/.virtualenvs/od/local/lib/python3.6/site-packages/tensorflow_core/python/framework/graph_util_impl.py:277: extract_sub_graph (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.extract_sub_graph`
INFO:tensorflow:Froze 322 variables.
INFO:tensorflow:Converted 322 variables to const ops.
INFO:root:Saved the frozen graph at /home/lindo/develop/smart-zoneminder/person-class/train-results/ResNet50-person-classifier.pb
